import{T as F}from"./download-todo-8e94FCaX.js";import{_ as B,r as h,s as L,o as M,a as A,c as g,b as o,w as l,d as U,e as S,F as P,f as O,g as N,h as I,i as V,j as R,k as W,l as r,m as v,n as u,t as f,p,q as E,u as j}from"./index-MTUZ50MT.js";const q={name:"download",components:{ToDownload:F},setup(){let d=h({showFtpTypePicker:!1,showLinkDiv:!1,showBtDiv:!1,showMetaLinkDiv:!1,downloads:[],timeout:null}),n=h({btContent:null,dir:L.state.options.dir,link:null,"max-connection-per-server":16,split:32,"ftp-type":null,"ftp-user":null,"ftp-passwd":null});const c=()=>{d.timeout&&clearTimeout(d.timeout),N().then(i=>{L.dispatch("filterStates",i.data);const a=i.data.filter(s=>s.id.indexOf("sendTellActiveREQ_")===0).map(s=>s.result);a&&a.length>0&&(d.downloads.length=0,d.downloads.push(...a[0])),d.timeout=setTimeout(c,1e3)})};c(),M(()=>{d.timeout&&clearTimeout(d.timeout)});const e=i=>{n["ftp-type"]=i,d.showFtpTypePicker=!1},C=()=>{n.btContent=void 0,n["mateContent "]=void 0,n["ftp-type"]===""&&(n["ftp-type"]=void 0),n["ftp-user"]===""&&(n["ftp-user"]=void 0),n["ftp-passwd"]===""&&(n["ftp-passwd"]=void 0),I(n.link,n).then(i=>{d.showLinkDiv=!1,V(`操作成功: ${i.data.result}`)})},D=()=>{n.link=void 0,n["mateContent "]=void 0,n["ftp-type"]=void 0,n["ftp-user"]=void 0,n["ftp-passwd"]=void 0,R(n.btContent,n).then(i=>{d.showBtDiv=!1,V(`操作成功: ${i.data.result}`)})},k=()=>{n.btContent=void 0,n.link=void 0,n["ftp-type"]=void 0,n["ftp-user"]=void 0,n["ftp-passwd"]=void 0,W(n.mateContent,n).then(i=>{d.showMetaLinkDiv=!1,V(`操作成功: ${i.data.result}`)})},_=i=>{let a=new FileReader;a.readAsDataURL(i.target.files[0]),a.onload=s=>{n.btContent=s.target.result.replace("data:application/octet-stream;base64,","").replace("data:application/x-bittorrent;base64,","")}},w=i=>{let a=new FileReader;a.readAsDataURL(i.target.files[0]),a.onload=s=>{n.mateContent=s.target.result.replace("data:application/octet-stream;base64,","").replace("data:application/x-bittorrent;base64,","")}};return{activeId:A("1"),linkTmp:n,onSaveLink:C,opts:d,onChooseFtpType:e,onSaveBt:D,changeBTCode:_,onSaveMetaLink:k,changeMetaLinkCode:w}}},m=d=>(E("data-v-5aef0527"),d=d(),j(),d),G={class:"download-area"},Q=m(()=>p("i",{class:"fa fa-link"},null,-1)),H=m(()=>p("i",{class:"fa fa-file-download"},null,-1)),J=m(()=>p("i",{class:"fa fa-bezier-curve"},null,-1)),K={key:1},X=m(()=>p("i",{class:"fa fa-magnet"},null,-1)),Y=m(()=>p("i",{class:"fa fa-broom"},null,-1)),Z=m(()=>p("i",{class:"fa fa-home"},null,-1)),$=m(()=>p("i",{class:"fa fa-cog"},null,-1)),nn={style:{margin:"16px"}},en=m(()=>p("i",{class:"fa fa-home"},null,-1)),on=m(()=>p("i",{class:"fa fa-cog"},null,-1)),tn={style:{margin:"16px"}},ln=m(()=>p("i",{class:"fa fa-home"},null,-1)),an=m(()=>p("i",{class:"fa fa-cog"},null,-1)),dn={style:{margin:"16px"}};function sn(d,n,c,e,C,D){const k=r("van-grid-item"),_=r("van-grid"),w=r("van-empty"),x=r("ToDownload"),i=r("van-button"),a=r("van-field"),s=r("van-slider"),y=r("van-cell-group"),b=r("van-form"),T=r("van-popup"),z=r("van-picker");return v(),g("div",G,[o(_,{"column-num":3},{default:l(()=>[o(k,{text:"URL",onClick:n[0]||(n[0]=t=>e.opts.showLinkDiv=!0)},{icon:l(()=>[Q]),_:1}),o(k,{text:"Torrent",onClick:n[1]||(n[1]=t=>e.opts.showBtDiv=!0)},{icon:l(()=>[H]),_:1}),o(k,{text:"MetaLink",onClick:n[2]||(n[2]=t=>e.opts.showMetaLinkDiv=!0)},{icon:l(()=>[J]),_:1})]),_:1}),e.opts.downloads.length===0?(v(),U(w,{key:0,description:"尚无任务"})):S("",!0),e.opts.downloads.length>0?(v(),g("div",K,[(v(!0),g(P,null,O(e.opts.downloads,t=>(v(),U(x,{key:t.id,todo:t},null,8,["todo"]))),128))])):S("",!0),o(T,{show:e.opts.showLinkDiv,"onUpdate:show":n[16]||(n[16]=t=>e.opts.showLinkDiv=t),position:"top"},{default:l(()=>[o(b,{onSubmit:e.onSaveLink},{default:l(()=>[o(y,{inset:""},{default:l(()=>[o(a,{label:"链接",value:"","input-align":"right",clearable:""},{input:l(()=>[o(i,{type:"primary",size:"mini",round:"",color:"purple",onClick:n[3]||(n[3]=t=>e.linkTmp.link="magnet:?xt=urn:btih:xxx")},{default:l(()=>[X]),_:1}),o(i,{type:"default",size:"mini",round:"",onClick:n[4]||(n[4]=t=>e.linkTmp.link="")},{default:l(()=>[Y]),_:1})]),_:1}),o(a,{modelValue:e.linkTmp.link,"onUpdate:modelValue":n[5]||(n[5]=t=>e.linkTmp.link=t),placeholder:"请输入",clickable:"",onClear:n[6]||(n[6]=t=>e.linkTmp.link=""),type:"textarea",rows:"3"},null,8,["modelValue"]),o(a,{modelValue:e.linkTmp.dir,"onUpdate:modelValue":n[7]||(n[7]=t=>e.linkTmp.dir=t),label:"下载路径",placeholder:"请输入"},null,8,["modelValue"]),o(a,{"input-align":"center"},{input:l(()=>[o(i,{type:"success",size:"mini",round:"",plain:"",onClick:n[8]||(n[8]=t=>e.linkTmp.dir="C:/Users/Administrator/Desktop")},{default:l(()=>[Z]),_:1}),o(i,{type:"success",size:"mini",round:"",plain:"",onClick:n[9]||(n[9]=t=>e.linkTmp.dir="D:/TDDOWNLOAD")},{default:l(()=>[$]),_:1})]),_:1}),o(a,{label:"最大连接数"},{input:l(()=>[o(s,{modelValue:e.linkTmp["max-connection-per-server"],"onUpdate:modelValue":n[10]||(n[10]=t=>e.linkTmp["max-connection-per-server"]=t),max:"16"},{button:l(()=>[o(i,{type:"primary",size:"mini",round:""},{default:l(()=>[u(f(e.linkTmp["max-connection-per-server"]),1)]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(a,{label:"最大线程数"},{input:l(()=>[o(s,{modelValue:e.linkTmp.split,"onUpdate:modelValue":n[11]||(n[11]=t=>e.linkTmp.split=t),max:"100"},{button:l(()=>[o(i,{type:"primary",size:"mini",round:""},{default:l(()=>[u(f(e.linkTmp.split),1)]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(a,{modelValue:e.linkTmp["ftp-type"],"onUpdate:modelValue":n[12]||(n[12]=t=>e.linkTmp["ftp-type"]=t),readonly:"",clickable:"",name:"picker",label:"FTP类型",placeholder:"点击选择",onClick:n[13]||(n[13]=t=>e.opts.showFtpTypePicker=!0)},null,8,["modelValue"]),o(a,{modelValue:e.linkTmp["ftp-user"],"onUpdate:modelValue":n[14]||(n[14]=t=>e.linkTmp["ftp-user"]=t),label:"FTP用户",placeholder:"请输入"},null,8,["modelValue"]),o(a,{modelValue:e.linkTmp["ftp-passwd"],"onUpdate:modelValue":n[15]||(n[15]=t=>e.linkTmp["ftp-passwd"]=t),label:"FTP密码",placeholder:"请输入"},null,8,["modelValue"])]),_:1}),p("div",nn,[o(i,{round:"",block:"",type:"primary","native-type":"submit"},{default:l(()=>[u(" 提交 ")]),_:1})])]),_:1},8,["onSubmit"])]),_:1},8,["show"]),o(T,{show:e.opts.showBtDiv,"onUpdate:show":n[22]||(n[22]=t=>e.opts.showBtDiv=t),position:"top"},{default:l(()=>[o(b,{onSubmit:e.onSaveBt},{default:l(()=>[o(y,{inset:""},{default:l(()=>[o(a,{label:"种子","input-align":"right",type:"file",onChange:e.changeBTCode},null,8,["onChange"]),o(a,{modelValue:e.linkTmp.dir,"onUpdate:modelValue":n[17]||(n[17]=t=>e.linkTmp.dir=t),label:"下载路径",placeholder:"请输入"},null,8,["modelValue"]),o(a,{"input-align":"center"},{input:l(()=>[o(i,{type:"success",size:"mini",round:"",plain:"",onClick:n[18]||(n[18]=t=>e.linkTmp.dir="C:/Users/Administrator/Desktop")},{default:l(()=>[en]),_:1}),o(i,{type:"success",size:"mini",round:"",plain:"",onClick:n[19]||(n[19]=t=>e.linkTmp.dir="D:/TDDOWNLOAD")},{default:l(()=>[on]),_:1})]),_:1}),o(a,{label:"最大连接数"},{input:l(()=>[o(s,{modelValue:e.linkTmp["max-connection-per-server"],"onUpdate:modelValue":n[20]||(n[20]=t=>e.linkTmp["max-connection-per-server"]=t),max:"16"},{button:l(()=>[o(i,{type:"primary",size:"mini",round:""},{default:l(()=>[u(f(e.linkTmp["max-connection-per-server"]),1)]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(a,{label:"最大线程数"},{input:l(()=>[o(s,{modelValue:e.linkTmp.split,"onUpdate:modelValue":n[21]||(n[21]=t=>e.linkTmp.split=t),max:"100"},{button:l(()=>[o(i,{type:"primary",size:"mini",round:""},{default:l(()=>[u(f(e.linkTmp.split),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),p("div",tn,[o(i,{round:"",block:"",type:"primary","native-type":"submit"},{default:l(()=>[u(" 提交 ")]),_:1})])]),_:1},8,["onSubmit"])]),_:1},8,["show"]),o(T,{show:e.opts.showMetaLinkDiv,"onUpdate:show":n[28]||(n[28]=t=>e.opts.showMetaLinkDiv=t),position:"top"},{default:l(()=>[o(b,{onSubmit:e.onSaveMetaLink},{default:l(()=>[o(y,{inset:""},{default:l(()=>[o(a,{label:"MetaLink","input-align":"right",type:"file",onChange:e.changeMetaLinkCode},null,8,["onChange"]),o(a,{modelValue:e.linkTmp.dir,"onUpdate:modelValue":n[23]||(n[23]=t=>e.linkTmp.dir=t),label:"下载路径",placeholder:"请输入"},null,8,["modelValue"]),o(a,{"input-align":"center"},{input:l(()=>[o(i,{type:"success",size:"mini",round:"",plain:"",onClick:n[24]||(n[24]=t=>e.linkTmp.dir="C:/Users/Administrator/Desktop")},{default:l(()=>[ln]),_:1}),o(i,{type:"success",size:"mini",round:"",plain:"",onClick:n[25]||(n[25]=t=>e.linkTmp.dir="D:/TDDOWNLOAD")},{default:l(()=>[an]),_:1})]),_:1}),o(a,{label:"最大连接数"},{input:l(()=>[o(s,{modelValue:e.linkTmp["max-connection-per-server"],"onUpdate:modelValue":n[26]||(n[26]=t=>e.linkTmp["max-connection-per-server"]=t),max:"16"},{button:l(()=>[o(i,{type:"primary",size:"mini",round:""},{default:l(()=>[u(f(e.linkTmp["max-connection-per-server"]),1)]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(a,{label:"最大线程数"},{input:l(()=>[o(s,{modelValue:e.linkTmp.split,"onUpdate:modelValue":n[27]||(n[27]=t=>e.linkTmp.split=t),max:"100"},{button:l(()=>[o(i,{type:"primary",size:"mini",round:""},{default:l(()=>[u(f(e.linkTmp.split),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),p("div",dn,[o(i,{round:"",block:"",type:"primary","native-type":"submit"},{default:l(()=>[u(" 提交 ")]),_:1})])]),_:1},8,["onSubmit"])]),_:1},8,["show"]),o(T,{show:e.opts.showFtpTypePicker,"onUpdate:show":n[30]||(n[30]=t=>e.opts.showFtpTypePicker=t),position:"bottom"},{default:l(()=>[o(z,{columns:["binary","ascii"],onConfirm:e.onChooseFtpType,onCancel:n[29]||(n[29]=t=>d.opt.showFtpTypePicker=!1)},null,8,["onConfirm"])]),_:1},8,["show"])])}const mn=B(q,[["render",sn],["__scopeId","data-v-5aef0527"]]);export{mn as default};
